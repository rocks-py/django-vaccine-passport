{% extends 'base.html'%}
{% load static %}


{%block content%}
    {% for person in person_list %}
    <div class="jumbotron vaccine-card">
      <div class="row">
        <div class="col-sm-2">
          <div class="avatar"></div>
        </div>
        <div class="col-sm-10">
          <div class="container-fluid">
            <h4 class="white-label">{{person.name}}</h4> <b>Уровень защищенности 7 / 9</b></h4>
            <div class="progress">
              <div class="progress-bar bg-success" role="progressbar" style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="90">
                <!-- <span class="progress-span">7 / 9</span> -->
                
              </div>
            </div>
            <div class="vaccine-card bg-white" style="height:160px; margin: 20px 0px; padding: 20px;">
              
              {% for vaccine_data in person.vaccine_data.all %}
              <div class="row vaccine__item {% if not vaccine_data.vaccination_date %}deactivated{%endif%}" data-toggle="modal" data-target="#exampleModal" 
                  disease-name="{{vaccine_data.disease.name}}" disease-id="{{vaccine_data.disease.pk}}" vaccine-id="{{vaccine_data.vaccine.pk}}" person-vaccine-id="{{vaccine_data.pk}}" person-vaccine-date="{{vaccine_data.vaccination_date | date:"Y-m-d"}}">
                
                
                <div class="col-sm-1">
                  {% if vaccine_data.vaccination_date %}
                  <img src="{% static 'img/check_icon.png' %}" width="20">
                  {%endif%}
                </div>
                
                
                <div class="col-sm-3">
                  <span>{{vaccine_data.disease.name}}</span>  
                </div>
                <div class="col-sm-6">
                  <span>{{vaccine_data.vaccine.name}}</span>  
                </div>
                {%if vaccine_data.vaccination_date %}
                <div class="col-sm-2">
                  <span>до {{vaccine_data.get_date_expire | date:"m/Y" }}</span>
                </div>
                {%endif%}
              </div>
              {% endfor %}

            
              <!-- <div class="row">
                <div class="col-sm-2">
                  <img src="img/check_icon.png" width="20">
                </div>
                <div class="col-sm-6">
                  <span style="font-size:20px;">коклюш</span>  
                </div>
                <div class="col-sm-4">
                  <span style="font-size:20px;">до 08/2024</span>
                </div>
              </div> -->

              <!-- <div class="row">
                <div class="col-sm-2">
                </div>
                <div class="col-sm-6">
                  <span style="font-size:20px; color:gray;">дифтерия</span>  
                </div>
                <div class="col-sm-4">
                  <span style="font-size:20px; color:gray;">не привит</span>
                </div>
              </div> -->
            </div>
          </div>
        </div>
      </div>
    </div>
    {%endfor%}
    
    


    <form method="POST">
      <div class="jumbotron vaccine-card" id="new_person_form">
        {% comment %} <div>
          <ul>
          {% for error in errors%}
          <li>{{error}}</li>
          {%endfor%}              
          </ul>        
        </div> {% endcomment %}
        <div class="row">
          <div class="col-sm-2">
            <div class="avatar"></div>
          </div>
          <div class="col-sm-10">
            {{personForm}}
          </div>
        </div>
        <div class="text-center">
          <input type="submit" value="Сохранить" class="btn btn-lg btn-primary btn-success align-middle" href="#" role="button" style="margin-top:20px;"></input>
        </div>
      </div>
      {%csrf_token%}
    </form>
    
    
    
    <div class="text-center" id="add_person_btn">
      <button type="button" class="btn add-btn align-middle">Добавить человека</button>
    </div>
    <script>
      var btn = document.querySelector("#add_person_btn");
      var personForm = document.querySelector("#new_person_form");
      btn.addEventListener('click', function (event) {
        // Don't follow the link
        event.preventDefault();
        // Log the clicked element in the console
        console.log(event.target);

        personForm.classList.remove('hide');
      }, false);
    </script>

  {%include 'modal.html'%}
{%endblock%}